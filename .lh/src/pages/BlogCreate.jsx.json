{
    "sourceFile": "src/pages/BlogCreate.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 20,
            "patches": [
                {
                    "date": 1762268926593,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1762276071605,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,29 +19,26 @@\n   useEffect(() => {\n     api.get(\"/api/categories\").then(({data}) => setCats(data));\n   }, []);\n \n-  // Quill image handler -> upload to /api/uploads/image -> insert URL\n   const quillRef = useRef(null);\n   const modules = {\n     toolbar: {\n       container: [\n         [{ header: [1,2,3,false] }],\n-        [\"bold\", \"italic\", \"underline\"],\n+        [\"bold\",\"italic\",\"underline\"],\n         [{ list: \"ordered\" }, { list: \"bullet\" }],\n-        [\"link\", \"image\"],\n+        [\"link\",\"image\"],\n         [\"clean\"]\n       ],\n       handlers: {\n         image: async function() {\n           const input = document.createElement(\"input\");\n-          input.type = \"file\";\n-          input.accept = \"image/*\";\n+          input.type = \"file\"; input.accept = \"image/*\";\n           input.onchange = async () => {\n-            const file = input.files[0];\n-            if (!file) return;\n+            const f = input.files?.[0]; if (!f) return;\n             const form = new FormData();\n-            form.append(\"image\", file);\n+            form.append(\"image\", f);\n             const token = localStorage.getItem(\"admin_token\");\n             const res = await fetch(`${import.meta.env.VITE_API_BASE}/api/uploads/image`, {\n               method: \"POST\",\n               headers: token ? { Authorization: `Bearer ${token}` } : undefined,\n@@ -59,9 +56,9 @@\n   };\n \n   async function submit(e) {\n     e.preventDefault();\n-    if (!title || !postedBy || !categoryId || !file || !contentHtml) return alert(\"Fill required fields\");\n+    if (!title || !postedBy || !categoryId || !file || !contentHtml) return alert(\"Fill all required fields\");\n     setSaving(true);\n     const form = new FormData();\n     form.append(\"title\", title);\n     form.append(\"postedBy\", postedBy);\n@@ -69,9 +66,9 @@\n     form.append(\"metaTitle\", metaTitle);\n     form.append(\"metaDescription\", metaDescription);\n     form.append(\"contentHtml\", contentHtml);\n     form.append(\"published\", \"true\");\n-    form.append(\"mainImage\", file); // multer field name\n+    form.append(\"mainImage\", file);\n \n     await adminFetch(\"/api/blogs\", { method: \"POST\", body: form });\n     window.location.href = \"/blogs\";\n   }\n@@ -87,19 +84,15 @@\n           <select value={categoryId} onChange={e=>setCategoryId(e.target.value)}>\n             <option value=\"\">Select category *</option>\n             {cats.map(c=><option key={c._id} value={c._id}>{c.name}</option>)}\n           </select>\n-\n           <label>Main Image *</label>\n-          <input type=\"file\" accept=\"image/*\" onChange={e=>setFile(e.target.files[0])} />\n-\n+          <input type=\"file\" accept=\"image/*\" onChange={e=>setFile(e.target.files?.[0] || null)} />\n           <label>Content (rich text) *</label>\n           <ReactQuill ref={quillRef} value={contentHtml} onChange={setContent} modules={modules} />\n-\n           <input placeholder=\"Meta Title\" value={metaTitle} onChange={e=>setMT(e.target.value)} />\n           <input placeholder=\"Meta Description\" value={metaDescription} onChange={e=>setMD(e.target.value)} />\n-\n-          <button disabled={saving}>{saving ? \"Saving...\" : \"Create\"}</button>\n+          <button disabled={saving} style={{background:\"#111\",color:\"#fff\"}}>{saving?\"Saving...\":\"Create\"}</button>\n         </form>\n       </div>\n     </>\n   );\n"
                },
                {
                    "date": 1762361921018,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,8 +3,9 @@\n import { adminFetch } from \"../api/adminFetch\";\n import ReactQuill from \"react-quill\";\n import \"react-quill/dist/quill.snow.css\";\n import Topbar from \"../components/Topbar\";\n+import { SECTION_OPTIONS } from \"../constants/sections\";\n \n export default function BlogCreate() {\n   const [cats, setCats] = useState([]);\n   const [title, setTitle] = useState(\"\");\n"
                },
                {
                    "date": 1762361928609,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,8 +15,9 @@\n   const [metaDescription, setMD] = useState(\"\");\n   const [contentHtml, setContent] = useState(\"\");\n   const [file, setFile] = useState(null);\n   const [saving, setSaving] = useState(false);\n+  const [sections, setSections] = useState([]);\n \n   useEffect(() => {\n     api.get(\"/api/categories\").then(({data}) => setCats(data));\n   }, []);\n"
                },
                {
                    "date": 1762361965060,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,8 +90,11 @@\n           <label>Main Image *</label>\n           <input type=\"file\" accept=\"image/*\" onChange={e=>setFile(e.target.files?.[0] || null)} />\n           <label>Content (rich text) *</label>\n           <ReactQuill ref={quillRef} value={contentHtml} onChange={setContent} modules={modules} />\n+\n+\n+          \n           <input placeholder=\"Meta Title\" value={metaTitle} onChange={e=>setMT(e.target.value)} />\n           <input placeholder=\"Meta Description\" value={metaDescription} onChange={e=>setMD(e.target.value)} />\n           <button disabled={saving} style={{background:\"#111\",color:\"#fff\"}}>{saving?\"Saving...\":\"Create\"}</button>\n         </form>\n"
                },
                {
                    "date": 1762362630445,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,8 +70,10 @@\n     form.append(\"contentHtml\", contentHtml);\n     form.append(\"published\", \"true\");\n     form.append(\"mainImage\", file);\n \n+    formData.append(\"sections\", JSON.stringify(sections));\n+\n     await adminFetch(\"/api/blogs\", { method: \"POST\", body: form });\n     window.location.href = \"/blogs\";\n   }\n \n@@ -91,10 +93,25 @@\n           <input type=\"file\" accept=\"image/*\" onChange={e=>setFile(e.target.files?.[0] || null)} />\n           <label>Content (rich text) *</label>\n           <ReactQuill ref={quillRef} value={contentHtml} onChange={setContent} modules={modules} />\n \n+          <label className=\"field-label\">Homepage Sections</label>\n+<select\n+  multiple\n+  value={sections}\n+  onChange={(e) =>\n+    setSections(Array.from(e.target.selectedOptions, o => o.value))\n+  }\n+  className=\"tf-input\"\n+  style={{ height: 120 }}\n+>\n+  {SECTION_OPTIONS.map(opt => (\n+    <option key={opt.value} value={opt.value}>{opt.label}</option>\n+  ))}\n+</select>\n+<small className=\"text-body-2\">Hold Cmd/Ctrl to multi-select.</small>\n \n-          \n+\n           <input placeholder=\"Meta Title\" value={metaTitle} onChange={e=>setMT(e.target.value)} />\n           <input placeholder=\"Meta Description\" value={metaDescription} onChange={e=>setMD(e.target.value)} />\n           <button disabled={saving} style={{background:\"#111\",color:\"#fff\"}}>{saving?\"Saving...\":\"Create\"}</button>\n         </form>\n"
                },
                {
                    "date": 1762362663790,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -70,9 +70,9 @@\n     form.append(\"contentHtml\", contentHtml);\n     form.append(\"published\", \"true\");\n     form.append(\"mainImage\", file);\n \n-    formData.append(\"sections\", JSON.stringify(sections));\n+    \n \n     await adminFetch(\"/api/blogs\", { method: \"POST\", body: form });\n     window.location.href = \"/blogs\";\n   }\n"
                },
                {
                    "date": 1762362753242,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -58,10 +58,14 @@\n   };\n \n   async function submit(e) {\n     e.preventDefault();\n-    if (!title || !postedBy || !categoryId || !file || !contentHtml) return alert(\"Fill all required fields\");\n+  \n+    if (!title || !postedBy || !categoryId || !file || !contentHtml)\n+      return alert(\"Fill all required fields\");\n+  \n     setSaving(true);\n+  \n     const form = new FormData();\n     form.append(\"title\", title);\n     form.append(\"postedBy\", postedBy);\n     form.append(\"categoryId\", categoryId);\n@@ -69,14 +73,18 @@\n     form.append(\"metaDescription\", metaDescription);\n     form.append(\"contentHtml\", contentHtml);\n     form.append(\"published\", \"true\");\n     form.append(\"mainImage\", file);\n-\n-    \n-\n+  \n+    // ✅ new field: add the selected homepage tags (array)\n+    // e.g. [\"latest_posts\", \"highlights\"]\n+    form.append(\"sections\", JSON.stringify(sections));\n+  \n     await adminFetch(\"/api/blogs\", { method: \"POST\", body: form });\n+  \n     window.location.href = \"/blogs\";\n   }\n+  \n \n   return (\n     <>\n       <Topbar/>\n"
                },
                {
                    "date": 1762365654116,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,23 +18,23 @@\n   const [saving, setSaving] = useState(false);\n   const [sections, setSections] = useState([]);\n \n   useEffect(() => {\n-    api.get(\"/api/categories\").then(({data}) => setCats(data));\n+    api.get(\"/api/categories\").then(({ data }) => setCats(data));\n   }, []);\n \n   const quillRef = useRef(null);\n   const modules = {\n     toolbar: {\n       container: [\n-        [{ header: [1,2,3,false] }],\n-        [\"bold\",\"italic\",\"underline\"],\n+        [{ header: [1, 2, 3, false] }],\n+        [\"bold\", \"italic\", \"underline\"],\n         [{ list: \"ordered\" }, { list: \"bullet\" }],\n-        [\"link\",\"image\"],\n+        [\"link\", \"image\"],\n         [\"clean\"]\n       ],\n       handlers: {\n-        image: async function() {\n+        image: async function () {\n           const input = document.createElement(\"input\");\n           input.type = \"file\"; input.accept = \"image/*\";\n           input.onchange = async () => {\n             const f = input.files?.[0]; if (!f) return;\n@@ -58,14 +58,14 @@\n   };\n \n   async function submit(e) {\n     e.preventDefault();\n-  \n+\n     if (!title || !postedBy || !categoryId || !file || !contentHtml)\n       return alert(\"Fill all required fields\");\n-  \n+\n     setSaving(true);\n-  \n+\n     const form = new FormData();\n     form.append(\"title\", title);\n     form.append(\"postedBy\", postedBy);\n     form.append(\"categoryId\", categoryId);\n@@ -73,56 +73,56 @@\n     form.append(\"metaDescription\", metaDescription);\n     form.append(\"contentHtml\", contentHtml);\n     form.append(\"published\", \"true\");\n     form.append(\"mainImage\", file);\n-  \n+\n     // ✅ new field: add the selected homepage tags (array)\n     // e.g. [\"latest_posts\", \"highlights\"]\n     form.append(\"sections\", JSON.stringify(sections));\n-  \n+\n     await adminFetch(\"/api/blogs\", { method: \"POST\", body: form });\n-  \n+\n     window.location.href = \"/blogs\";\n   }\n-  \n \n+\n   return (\n     <>\n-      <Topbar/>\n+      <Topbar />\n       <div className=\"page\">\n         <h2>Create Blog</h2>\n         <form onSubmit={submit} className=\"card\">\n-          <input placeholder=\"Title *\" value={title} onChange={e=>setTitle(e.target.value)} />\n-          <input placeholder=\"Posted by *\" value={postedBy} onChange={e=>setPostedBy(e.target.value)} />\n-          <select value={categoryId} onChange={e=>setCategoryId(e.target.value)}>\n+          <input placeholder=\"Title *\" value={title} onChange={e => setTitle(e.target.value)} />\n+          <input placeholder=\"Posted by *\" value={postedBy} onChange={e => setPostedBy(e.target.value)} />\n+          <select value={categoryId} onChange={e => setCategoryId(e.target.value)}>\n             <option value=\"\">Select category *</option>\n-            {cats.map(c=><option key={c._id} value={c._id}>{c.name}</option>)}\n+            {cats.map(c => <option key={c._id} value={c._id}>{c.name}</option>)}\n           </select>\n           <label>Main Image *</label>\n-          <input type=\"file\" accept=\"image/*\" onChange={e=>setFile(e.target.files?.[0] || null)} />\n+          <input type=\"file\" accept=\"image/*\" onChange={e => setFile(e.target.files?.[0] || null)} />\n           <label>Content (rich text) *</label>\n           <ReactQuill ref={quillRef} value={contentHtml} onChange={setContent} modules={modules} />\n \n           <label className=\"field-label\">Homepage Sections</label>\n-<select\n-  multiple\n-  value={sections}\n-  onChange={(e) =>\n-    setSections(Array.from(e.target.selectedOptions, o => o.value))\n-  }\n-  className=\"tf-input\"\n-  style={{ height: 120 }}\n->\n-  {SECTION_OPTIONS.map(opt => (\n-    <option key={opt.value} value={opt.value}>{opt.label}</option>\n-  ))}\n-</select>\n-<small className=\"text-body-2\">Hold Cmd/Ctrl to multi-select.</small>\n+          <select\n+            multiple\n+            value={sections}\n+            onChange={(e) =>\n+              setSections(Array.from(e.target.selectedOptions, o => o.value))\n+            }\n+            className=\"tf-input\"\n+            style={{ height: 120 }}\n+          >\n+            {SECTION_OPTIONS.map(opt => (\n+              <option key={opt.value} value={opt.value}>{opt.label}</option>\n+            ))}\n+          </select>\n+          <small className=\"text-body-2\">Hold Cmd/Ctrl to multi-select.</small>\n \n \n-          <input placeholder=\"Meta Title\" value={metaTitle} onChange={e=>setMT(e.target.value)} />\n-          <input placeholder=\"Meta Description\" value={metaDescription} onChange={e=>setMD(e.target.value)} />\n-          <button disabled={saving} style={{background:\"#111\",color:\"#fff\"}}>{saving?\"Saving...\":\"Create\"}</button>\n+          <input placeholder=\"Meta Title\" value={metaTitle} onChange={e => setMT(e.target.value)} />\n+          <input placeholder=\"Meta Description\" value={metaDescription} onChange={e => setMD(e.target.value)} />\n+          <button disabled={saving} style={{ background: \"#111\", color: \"#fff\" }}>{saving ? \"Saving...\" : \"Create\"}</button>\n         </form>\n       </div>\n     </>\n   );\n"
                },
                {
                    "date": 1762365685574,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -101,22 +101,21 @@\n           <input type=\"file\" accept=\"image/*\" onChange={e => setFile(e.target.files?.[0] || null)} />\n           <label>Content (rich text) *</label>\n           <ReactQuill ref={quillRef} value={contentHtml} onChange={setContent} modules={modules} />\n \n-          <label className=\"field-label\">Homepage Sections</label>\n-          <select\n-            multiple\n-            value={sections}\n-            onChange={(e) =>\n-              setSections(Array.from(e.target.selectedOptions, o => o.value))\n-            }\n-            className=\"tf-input\"\n-            style={{ height: 120 }}\n-          >\n-            {SECTION_OPTIONS.map(opt => (\n-              <option key={opt.value} value={opt.value}>{opt.label}</option>\n-            ))}\n-          </select>\n+          <label className=\"field-label\">Homepage Section</label>\n+<select\n+  value={sections[0] || \"\"}\n+  onChange={(e) => setSections(e.target.value ? [e.target.value] : [])}\n+  className=\"tf-input\"\n+>\n+  <option value=\"\">Choose homepage section</option>\n+  <option value=\"top_new\">Top New</option>\n+  <option value=\"most_popular\">Most Popular</option>\n+  <option value=\"editors_pick\">Editor Pick's</option>\n+  <option value=\"latest_posts\">Latest Posts</option>\n+  <option value=\"highlights\">Highlights</option>\n+</select>\n           <small className=\"text-body-2\">Hold Cmd/Ctrl to multi-select.</small>\n \n \n           <input placeholder=\"Meta Title\" value={metaTitle} onChange={e => setMT(e.target.value)} />\n"
                },
                {
                    "date": 1762544950442,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -113,8 +113,9 @@\n   <option value=\"most_popular\">Most Popular</option>\n   <option value=\"editors_pick\">Editor Pick's</option>\n   <option value=\"latest_posts\">Latest Posts</option>\n   <option value=\"highlights\">Highlights</option>\n+  <option value=\"banner\">Banner</option>\n </select>\n           <small className=\"text-body-2\">Hold Cmd/Ctrl to multi-select.</small>\n \n \n"
                },
                {
                    "date": 1762628783112,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -120,8 +120,17 @@\n \n \n           <input placeholder=\"Meta Title\" value={metaTitle} onChange={e => setMT(e.target.value)} />\n           <input placeholder=\"Meta Description\" value={metaDescription} onChange={e => setMD(e.target.value)} />\n+\n+          <label className=\"field-label\">Schema Markup (optional)</label>\n+<textarea\n+  placeholder=\"Paste JSON-LD or custom schema here...\"\n+  rows={6}\n+  value={schemaMarkup}\n+  onChange={(e) => setSchemaMarkup(e.target.value)}\n+  style={{ fontFamily: \"monospace\", fontSize: 13 }}\n+/>\n           <button disabled={saving} style={{ background: \"#111\", color: \"#fff\" }}>{saving ? \"Saving...\" : \"Create\"}</button>\n         </form>\n       </div>\n     </>\n"
                },
                {
                    "date": 1762628809706,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -16,9 +16,11 @@\n   const [contentHtml, setContent] = useState(\"\");\n   const [file, setFile] = useState(null);\n   const [saving, setSaving] = useState(false);\n   const [sections, setSections] = useState([]);\n+  const [schemaMarkup, setSchemaMarkup] = useState(\"\");\n \n+\n   useEffect(() => {\n     api.get(\"/api/categories\").then(({ data }) => setCats(data));\n   }, []);\n \n"
                },
                {
                    "date": 1762628825017,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -75,9 +75,11 @@\n     form.append(\"metaDescription\", metaDescription);\n     form.append(\"contentHtml\", contentHtml);\n     form.append(\"published\", \"true\");\n     form.append(\"mainImage\", file);\n+    form.append(\"schemaMarkup\", schemaMarkup);\n \n+\n     // ✅ new field: add the selected homepage tags (array)\n     // e.g. [\"latest_posts\", \"highlights\"]\n     form.append(\"sections\", JSON.stringify(sections));\n \n"
                },
                {
                    "date": 1763640166135,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -76,8 +76,9 @@\n     form.append(\"contentHtml\", contentHtml);\n     form.append(\"published\", \"true\");\n     form.append(\"mainImage\", file);\n     form.append(\"schemaMarkup\", schemaMarkup);\n+    form.append(\"contentHtml\", contentHtml);\n \n \n     // ✅ new field: add the selected homepage tags (array)\n     // e.g. [\"latest_posts\", \"highlights\"]\n"
                },
                {
                    "date": 1763640179894,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -76,9 +76,9 @@\n     form.append(\"contentHtml\", contentHtml);\n     form.append(\"published\", \"true\");\n     form.append(\"mainImage\", file);\n     form.append(\"schemaMarkup\", schemaMarkup);\n-    form.append(\"contentHtml\", contentHtml);\n+    \n \n \n     // ✅ new field: add the selected homepage tags (array)\n     // e.g. [\"latest_posts\", \"highlights\"]\n"
                },
                {
                    "date": 1763640641971,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -107,13 +107,13 @@\n           <label>Content (rich text) *</label>\n           <ReactQuill ref={quillRef} value={contentHtml} onChange={setContent} modules={modules} />\n \n           <label className=\"field-label\">Homepage Section</label>\n-<select\n+{/* <select\n   value={sections[0] || \"\"}\n   onChange={(e) => setSections(e.target.value ? [e.target.value] : [])}\n   className=\"tf-input\"\n->\n+> */}\n   <option value=\"\">Choose homepage section</option>\n   <option value=\"top_new\">Top New</option>\n   <option value=\"most_popular\">Most Popular</option>\n   <option value=\"editors_pick\">Editor Pick's</option>\n"
                },
                {
                    "date": 1763640649359,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -107,13 +107,13 @@\n           <label>Content (rich text) *</label>\n           <ReactQuill ref={quillRef} value={contentHtml} onChange={setContent} modules={modules} />\n \n           <label className=\"field-label\">Homepage Section</label>\n-{/* <select\n-  value={sections[0] || \"\"}\n-  onChange={(e) => setSections(e.target.value ? [e.target.value] : [])}\n-  className=\"tf-input\"\n-> */}\n+          <select\n+  value={sections}\n+  onChange={(e) => setSections([e.target.value])}\n+>\n+\n   <option value=\"\">Choose homepage section</option>\n   <option value=\"top_new\">Top New</option>\n   <option value=\"most_popular\">Most Popular</option>\n   <option value=\"editors_pick\">Editor Pick's</option>\n"
                },
                {
                    "date": 1763640928116,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-import { useEffect, useRef, useState } from \"react\";\n+import { useEffect, useRef, useState, useMemo } from \"react\";\n import { api } from \"../api/client\";\n import { adminFetch } from \"../api/adminFetch\";\n import ReactQuill from \"react-quill\";\n import \"react-quill/dist/quill.snow.css\";\n"
                },
                {
                    "date": 1763640967763,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,41 +24,41 @@\n     api.get(\"/api/categories\").then(({ data }) => setCats(data));\n   }, []);\n \n   const quillRef = useRef(null);\n-  const modules = {\n-    toolbar: {\n-      container: [\n-        [{ header: [1, 2, 3, false] }],\n-        [\"bold\", \"italic\", \"underline\"],\n-        [{ list: \"ordered\" }, { list: \"bullet\" }],\n-        [\"link\", \"image\"],\n-        [\"clean\"]\n-      ],\n-      handlers: {\n-        image: async function () {\n-          const input = document.createElement(\"input\");\n-          input.type = \"file\"; input.accept = \"image/*\";\n-          input.onchange = async () => {\n-            const f = input.files?.[0]; if (!f) return;\n-            const form = new FormData();\n-            form.append(\"image\", f);\n-            const token = localStorage.getItem(\"admin_token\");\n-            const res = await fetch(`${import.meta.env.VITE_API_BASE}/api/uploads/image`, {\n-              method: \"POST\",\n-              headers: token ? { Authorization: `Bearer ${token}` } : undefined,\n-              body: form\n-            });\n-            const { url } = await res.json();\n-            const editor = quillRef.current.getEditor();\n-            const range = editor.getSelection(true);\n-            editor.insertEmbed(range.index, \"image\", url);\n-          };\n-          input.click();\n-        }\n-      }\n-    }\n-  };\n+  // const modules = {\n+  //   toolbar: {\n+  //     container: [\n+  //       [{ header: [1, 2, 3, false] }],\n+  //       [\"bold\", \"italic\", \"underline\"],\n+  //       [{ list: \"ordered\" }, { list: \"bullet\" }],\n+  //       [\"link\", \"image\"],\n+  //       [\"clean\"]\n+  //     ],\n+  //     handlers: {\n+  //       image: async function () {\n+  //         const input = document.createElement(\"input\");\n+  //         input.type = \"file\"; input.accept = \"image/*\";\n+  //         input.onchange = async () => {\n+  //           const f = input.files?.[0]; if (!f) return;\n+  //           const form = new FormData();\n+  //           form.append(\"image\", f);\n+  //           const token = localStorage.getItem(\"admin_token\");\n+  //           const res = await fetch(`${import.meta.env.VITE_API_BASE}/api/uploads/image`, {\n+  //             method: \"POST\",\n+  //             headers: token ? { Authorization: `Bearer ${token}` } : undefined,\n+  //             body: form\n+  //           });\n+  //           const { url } = await res.json();\n+  //           const editor = quillRef.current.getEditor();\n+  //           const range = editor.getSelection(true);\n+  //           editor.insertEmbed(range.index, \"image\", url);\n+  //         };\n+  //         input.click();\n+  //       }\n+  //     }\n+  //   }\n+  // };\n \n   async function submit(e) {\n     e.preventDefault();\n \n"
                },
                {
                    "date": 1763640988380,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -58,8 +58,54 @@\n   //     }\n   //   }\n   // };\n \n+\n+  const modules = useMemo(() => ({\n+    toolbar: {\n+      container: [\n+        [{ header: [1, 2, 3, false] }],\n+        [\"bold\", \"italic\", \"underline\"],\n+        [{ list: \"ordered\" }, { list: \"bullet\" }],\n+        [\"link\", \"image\"],\n+        [\"clean\"]\n+      ],\n+      handlers: {\n+        image: async function () {\n+          const input = document.createElement(\"input\");\n+          input.type = \"file\"; \n+          input.accept = \"image/*\";\n+  \n+          input.onchange = async () => {\n+            const f = input.files?.[0];\n+            if (!f) return;\n+  \n+            const form = new FormData();\n+            form.append(\"image\", f);\n+  \n+            const token = localStorage.getItem(\"admin_token\");\n+            const res = await fetch(\n+              `${import.meta.env.VITE_API_BASE}/api/uploads/image`,\n+              {\n+                method: \"POST\",\n+                headers: token ? { Authorization: `Bearer ${token}` } : undefined,\n+                body: form,\n+              }\n+            );\n+  \n+            const { url } = await res.json();\n+            const editor = quillRef.current.getEditor();\n+            const range = editor.getSelection(true);\n+            editor.insertEmbed(range.index, \"image\", url);\n+          };\n+  \n+          input.click();\n+        }\n+      }\n+    }\n+  }), []); // VERY IMPORTANT\n+  \n+\n   async function submit(e) {\n     e.preventDefault();\n \n     if (!title || !postedBy || !categoryId || !file || !contentHtml)\n@@ -108,9 +154,9 @@\n           <ReactQuill ref={quillRef} value={contentHtml} onChange={setContent} modules={modules} />\n \n           <label className=\"field-label\">Homepage Section</label>\n           <select\n-  value={sections}\n+  value={sections[0] || \"\"}\n   onChange={(e) => setSections([e.target.value])}\n >\n \n   <option value=\"\">Choose homepage section</option>\n"
                }
            ],
            "date": 1762268926593,
            "name": "Commit-0",
            "content": "import { useEffect, useRef, useState } from \"react\";\nimport { api } from \"../api/client\";\nimport { adminFetch } from \"../api/adminFetch\";\nimport ReactQuill from \"react-quill\";\nimport \"react-quill/dist/quill.snow.css\";\nimport Topbar from \"../components/Topbar\";\n\nexport default function BlogCreate() {\n  const [cats, setCats] = useState([]);\n  const [title, setTitle] = useState(\"\");\n  const [postedBy, setPostedBy] = useState(\"\");\n  const [categoryId, setCategoryId] = useState(\"\");\n  const [metaTitle, setMT] = useState(\"\");\n  const [metaDescription, setMD] = useState(\"\");\n  const [contentHtml, setContent] = useState(\"\");\n  const [file, setFile] = useState(null);\n  const [saving, setSaving] = useState(false);\n\n  useEffect(() => {\n    api.get(\"/api/categories\").then(({data}) => setCats(data));\n  }, []);\n\n  // Quill image handler -> upload to /api/uploads/image -> insert URL\n  const quillRef = useRef(null);\n  const modules = {\n    toolbar: {\n      container: [\n        [{ header: [1,2,3,false] }],\n        [\"bold\", \"italic\", \"underline\"],\n        [{ list: \"ordered\" }, { list: \"bullet\" }],\n        [\"link\", \"image\"],\n        [\"clean\"]\n      ],\n      handlers: {\n        image: async function() {\n          const input = document.createElement(\"input\");\n          input.type = \"file\";\n          input.accept = \"image/*\";\n          input.onchange = async () => {\n            const file = input.files[0];\n            if (!file) return;\n            const form = new FormData();\n            form.append(\"image\", file);\n            const token = localStorage.getItem(\"admin_token\");\n            const res = await fetch(`${import.meta.env.VITE_API_BASE}/api/uploads/image`, {\n              method: \"POST\",\n              headers: token ? { Authorization: `Bearer ${token}` } : undefined,\n              body: form\n            });\n            const { url } = await res.json();\n            const editor = quillRef.current.getEditor();\n            const range = editor.getSelection(true);\n            editor.insertEmbed(range.index, \"image\", url);\n          };\n          input.click();\n        }\n      }\n    }\n  };\n\n  async function submit(e) {\n    e.preventDefault();\n    if (!title || !postedBy || !categoryId || !file || !contentHtml) return alert(\"Fill required fields\");\n    setSaving(true);\n    const form = new FormData();\n    form.append(\"title\", title);\n    form.append(\"postedBy\", postedBy);\n    form.append(\"categoryId\", categoryId);\n    form.append(\"metaTitle\", metaTitle);\n    form.append(\"metaDescription\", metaDescription);\n    form.append(\"contentHtml\", contentHtml);\n    form.append(\"published\", \"true\");\n    form.append(\"mainImage\", file); // multer field name\n\n    await adminFetch(\"/api/blogs\", { method: \"POST\", body: form });\n    window.location.href = \"/blogs\";\n  }\n\n  return (\n    <>\n      <Topbar/>\n      <div className=\"page\">\n        <h2>Create Blog</h2>\n        <form onSubmit={submit} className=\"card\">\n          <input placeholder=\"Title *\" value={title} onChange={e=>setTitle(e.target.value)} />\n          <input placeholder=\"Posted by *\" value={postedBy} onChange={e=>setPostedBy(e.target.value)} />\n          <select value={categoryId} onChange={e=>setCategoryId(e.target.value)}>\n            <option value=\"\">Select category *</option>\n            {cats.map(c=><option key={c._id} value={c._id}>{c.name}</option>)}\n          </select>\n\n          <label>Main Image *</label>\n          <input type=\"file\" accept=\"image/*\" onChange={e=>setFile(e.target.files[0])} />\n\n          <label>Content (rich text) *</label>\n          <ReactQuill ref={quillRef} value={contentHtml} onChange={setContent} modules={modules} />\n\n          <input placeholder=\"Meta Title\" value={metaTitle} onChange={e=>setMT(e.target.value)} />\n          <input placeholder=\"Meta Description\" value={metaDescription} onChange={e=>setMD(e.target.value)} />\n\n          <button disabled={saving}>{saving ? \"Saving...\" : \"Create\"}</button>\n        </form>\n      </div>\n    </>\n  );\n}\n"
        }
    ]
}