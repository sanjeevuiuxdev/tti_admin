{
    "sourceFile": "src/pages/BlogEdit.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 9,
            "patches": [
                {
                    "date": 1762276080720,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1762361995236,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,9 +4,11 @@\n import { adminFetch } from \"../api/adminFetch\";\n import ReactQuill from \"react-quill\";\n import \"react-quill/dist/quill.snow.css\";\n import Topbar from \"../components/Topbar\";\n+import { SECTION_OPTIONS } from \"../constants/sections\";\n \n+\n export default function BlogEdit() {\n   const { id } = useParams();\n   const [cats, setCats] = useState([]);\n   const [blog, setBlog] = useState(null);\n"
                },
                {
                    "date": 1762362000646,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,8 +13,9 @@\n   const [cats, setCats] = useState([]);\n   const [blog, setBlog] = useState(null);\n   const [saving, setSaving] = useState(false);\n   const [newFile, setNewFile] = useState(null);\n+  const [sections, setSections] = useState([]);\n \n   useEffect(() => {\n     (async () => {\n       const { data: catsData } = await api.get(\"/api/categories\");\n"
                },
                {
                    "date": 1762362017113,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -105,8 +105,23 @@\n           <label>Replace Main Image (optional)</label>\n           <input type=\"file\" accept=\"image/*\" onChange={e=>setNewFile(e.target.files?.[0] || null)} />\n           <label>Content (rich text) *</label>\n           <ReactQuill ref={quillRef} value={blog.contentHtml} onChange={v=>setBlog(s=>({...s, contentHtml:v}))} modules={modules} />\n+          <label className=\"field-label\">Homepage Sections</label>\n+<select\n+  multiple\n+  value={sections}\n+  onChange={(e) =>\n+    setSections(Array.from(e.target.selectedOptions, o => o.value))\n+  }\n+  className=\"tf-input\"\n+  style={{ height: 120 }}\n+>\n+  {SECTION_OPTIONS.map(opt => (\n+    <option key={opt.value} value={opt.value}>{opt.label}</option>\n+  ))}\n+</select>\n+<small className=\"text-body-2\">Hold Cmd/Ctrl to multi-select.</small>\n           <input placeholder=\"Meta Title\" value={blog.metaTitle} onChange={e=>setBlog(s=>({...s, metaTitle:e.target.value}))} />\n           <input placeholder=\"Meta Description\" value={blog.metaDescription} onChange={e=>setBlog(s=>({...s, metaDescription:e.target.value}))} />\n           <label style={{display:\"flex\",gap:8,alignItems:\"center\"}}>\n             <input type=\"checkbox\" checked={blog.published} onChange={e=>setBlog(s=>({...s, published:e.target.checked}))}/>\n"
                },
                {
                    "date": 1762362931412,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -75,21 +75,28 @@\n \n   async function submit(e) {\n     e.preventDefault();\n     setSaving(true);\n+  \n     const form = new FormData();\n     form.append(\"title\", blog.title);\n     form.append(\"postedBy\", blog.postedBy);\n     form.append(\"categoryId\", blog.categoryId);\n-    form.append(\"metaTitle\", blog.metaTitle);\n-    form.append(\"metaDescription\", blog.metaDescription);\n-    form.append(\"contentHtml\", blog.contentHtml);\n+    form.append(\"metaTitle\", blog.metaTitle || \"\");\n+    form.append(\"metaDescription\", blog.metaDescription || \"\");\n+    form.append(\"contentHtml\", blog.contentHtml || \"\");\n     form.append(\"published\", String(blog.published));\n-    if (newFile) form.append(\"mainImage\", newFile);\n-\n+  \n+    // ✅ send sections (array -> JSON string)\n+    // Ensure blog.sections is an array like [\"latest_posts\",\"highlights\"]\n+    form.append(\"sections\", JSON.stringify(blog.sections || []));\n+  \n+    if (newFile) form.append(\"mainImage\", newFile); // optional replace\n+  \n     await adminFetch(`/api/blogs/${id}`, { method: \"PUT\", body: form });\n     window.location.href = \"/blogs\";\n   }\n+  \n \n   return (\n     <>\n       <Topbar/>\n"
                },
                {
                    "date": 1762587801452,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,136 +6,208 @@\n import \"react-quill/dist/quill.snow.css\";\n import Topbar from \"../components/Topbar\";\n import { SECTION_OPTIONS } from \"../constants/sections\";\n \n+type BlogForm = {\n+  title: string;\n+  postedBy: string;\n+  categoryId: string;\n+  metaTitle?: string;\n+  metaDescription?: string;\n+  contentHtml: string;\n+  published: boolean;\n+};\n \n export default function BlogEdit() {\n   const { id } = useParams();\n-  const [cats, setCats] = useState([]);\n-  const [blog, setBlog] = useState(null);\n+  const [cats, setCats] = useState<any[]>([]);\n+  const [blog, setBlog] = useState<BlogForm | null>(null);\n+  const [sections, setSections] = useState<string[]>([]);     // ✅ single source for sections\n   const [saving, setSaving] = useState(false);\n-  const [newFile, setNewFile] = useState(null);\n-  const [sections, setSections] = useState([]);\n+  const [newFile, setNewFile] = useState<File | null>(null);\n \n   useEffect(() => {\n     (async () => {\n+      // categories\n       const { data: catsData } = await api.get(\"/api/categories\");\n       setCats(catsData);\n-      // fallback: fetch all blogs and find by id\n+\n+      // load blog by id\n       const { data: blogs } = await api.get(\"/api/blogs\");\n-      const found = blogs.find(b => b._id === id);\n-      if (!found) { alert(\"Blog not found\"); window.location.href=\"/blogs\"; return; }\n+      const found = blogs.find((b: any) => b._id === id);\n+      if (!found) {\n+        alert(\"Blog not found\");\n+        window.location.href = \"/blogs\";\n+        return;\n+      }\n+\n       setBlog({\n-        title: found.title,\n-        postedBy: found.postedBy,\n-        categoryId: found.category?._id || found.category,\n-        metaTitle: found.metaTitle || \"\",\n+        title:         found.title,\n+        postedBy:      found.postedBy,\n+        categoryId:    found.category?._id || found.category,\n+        metaTitle:     found.metaTitle || \"\",\n         metaDescription: found.metaDescription || \"\",\n-        contentHtml: found.contentHtml || \"\",\n-        published: !!found.published,\n+        contentHtml:   found.contentHtml || \"\",\n+        published:     !!found.published,\n       });\n+\n+      // ✅ preload sections (array) for the dropdown\n+      setSections(Array.isArray(found.sections) ? found.sections : []);\n     })();\n   }, [id]);\n \n-  const quillRef = useRef(null);\n+  const quillRef = useRef<any>(null);\n   const modules = {\n     toolbar: {\n       container: [\n-        [{ header: [1,2,3,false] }],\n-        [\"bold\",\"italic\",\"underline\"],\n+        [{ header: [1, 2, 3, false] }],\n+        [\"bold\", \"italic\", \"underline\"],\n         [{ list: \"ordered\" }, { list: \"bullet\" }],\n-        [\"link\",\"image\"],\n-        [\"clean\"]\n+        [\"link\", \"image\"],\n+        [\"clean\"],\n       ],\n       handlers: {\n-        image: async function() {\n+        image: async function () {\n           const input = document.createElement(\"input\");\n-          input.type = \"file\"; input.accept = \"image/*\";\n+          input.type = \"file\";\n+          input.accept = \"image/*\";\n           input.onchange = async () => {\n-            const f = input.files?.[0]; if (!f) return;\n+            const f = input.files?.[0];\n+            if (!f) return;\n             const form = new FormData();\n             form.append(\"image\", f);\n             const token = localStorage.getItem(\"admin_token\");\n-            const res = await fetch(`${import.meta.env.VITE_API_BASE}/api/uploads/image`, {\n-              method: \"POST\",\n-              headers: token ? { Authorization: `Bearer ${token}` } : undefined,\n-              body: form\n-            });\n+            const res = await fetch(\n+              `${import.meta.env.VITE_API_BASE}/api/uploads/image`,\n+              {\n+                method: \"POST\",\n+                headers: token ? { Authorization: `Bearer ${token}` } : undefined,\n+                body: form,\n+              }\n+            );\n             const { url } = await res.json();\n             const editor = quillRef.current.getEditor();\n             const range = editor.getSelection(true);\n             editor.insertEmbed(range.index, \"image\", url);\n           };\n           input.click();\n-        }\n-      }\n-    }\n+        },\n+      },\n+    },\n   };\n \n-  if (!blog) return (<><Topbar/><div className=\"page\">Loading...</div></>);\n+  if (!blog) return (<><Topbar /><div className=\"page\">Loading...</div></>);\n \n-  async function submit(e) {\n+  async function submit(e: React.FormEvent) {\n     e.preventDefault();\n     setSaving(true);\n-  \n+\n     const form = new FormData();\n     form.append(\"title\", blog.title);\n     form.append(\"postedBy\", blog.postedBy);\n     form.append(\"categoryId\", blog.categoryId);\n     form.append(\"metaTitle\", blog.metaTitle || \"\");\n     form.append(\"metaDescription\", blog.metaDescription || \"\");\n     form.append(\"contentHtml\", blog.contentHtml || \"\");\n     form.append(\"published\", String(blog.published));\n-  \n-    // ✅ send sections (array -> JSON string)\n-    // Ensure blog.sections is an array like [\"latest_posts\",\"highlights\"]\n-    form.append(\"sections\", JSON.stringify(blog.sections || []));\n-  \n-    if (newFile) form.append(\"mainImage\", newFile); // optional replace\n-  \n+\n+    // ✅ send the currently selected section(s)\n+    form.append(\"sections\", JSON.stringify(sections));  // single or empty\n+\n+    if (newFile) form.append(\"mainImage\", newFile);\n+\n     await adminFetch(`/api/blogs/${id}`, { method: \"PUT\", body: form });\n     window.location.href = \"/blogs\";\n   }\n-  \n \n   return (\n     <>\n-      <Topbar/>\n+      <Topbar />\n       <div className=\"page\">\n         <h2>Edit Blog</h2>\n         <form onSubmit={submit} className=\"card\">\n-          <input placeholder=\"Title *\" value={blog.title} onChange={e=>setBlog(s=>({...s, title:e.target.value}))} />\n-          <input placeholder=\"Posted by *\" value={blog.postedBy} onChange={e=>setBlog(s=>({...s, postedBy:e.target.value}))} />\n-          <select value={blog.categoryId} onChange={e=>setBlog(s=>({...s, categoryId:e.target.value}))}>\n+          <input\n+            placeholder=\"Title *\"\n+            value={blog.title}\n+            onChange={(e) => setBlog((s) => ({ ...s!, title: e.target.value }))}\n+          />\n+          <input\n+            placeholder=\"Posted by *\"\n+            value={blog.postedBy}\n+            onChange={(e) => setBlog((s) => ({ ...s!, postedBy: e.target.value }))}\n+          />\n+          <select\n+            value={blog.categoryId}\n+            onChange={(e) => setBlog((s) => ({ ...s!, categoryId: e.target.value }))}\n+          >\n             <option value=\"\">Select category *</option>\n-            {cats.map(c=><option key={c._id} value={c._id}>{c.name}</option>)}\n+            {cats.map((c) => (\n+              <option key={c._id} value={c._id}>\n+                {c.name}\n+              </option>\n+            ))}\n           </select>\n+\n           <label>Replace Main Image (optional)</label>\n-          <input type=\"file\" accept=\"image/*\" onChange={e=>setNewFile(e.target.files?.[0] || null)} />\n+          <input\n+            type=\"file\"\n+            accept=\"image/*\"\n+            onChange={(e) => setNewFile(e.target.files?.[0] || null)}\n+          />\n+\n           <label>Content (rich text) *</label>\n-          <ReactQuill ref={quillRef} value={blog.contentHtml} onChange={v=>setBlog(s=>({...s, contentHtml:v}))} modules={modules} />\n-          <label className=\"field-label\">Homepage Sections</label>\n-<select\n-  multiple\n-  value={sections}\n-  onChange={(e) =>\n-    setSections(Array.from(e.target.selectedOptions, o => o.value))\n-  }\n-  className=\"tf-input\"\n-  style={{ height: 120 }}\n->\n-  {SECTION_OPTIONS.map(opt => (\n-    <option key={opt.value} value={opt.value}>{opt.label}</option>\n-  ))}\n-</select>\n-<small className=\"text-body-2\">Hold Cmd/Ctrl to multi-select.</small>\n-          <input placeholder=\"Meta Title\" value={blog.metaTitle} onChange={e=>setBlog(s=>({...s, metaTitle:e.target.value}))} />\n-          <input placeholder=\"Meta Description\" value={blog.metaDescription} onChange={e=>setBlog(s=>({...s, metaDescription:e.target.value}))} />\n-          <label style={{display:\"flex\",gap:8,alignItems:\"center\"}}>\n-            <input type=\"checkbox\" checked={blog.published} onChange={e=>setBlog(s=>({...s, published:e.target.checked}))}/>\n+          <ReactQuill\n+            ref={quillRef}\n+            value={blog.contentHtml}\n+            onChange={(v) => setBlog((s) => ({ ...s!, contentHtml: v }))}\n+            modules={modules}\n+          />\n+\n+          {/* ✅ single dropdown, same as Create */}\n+          <label className=\"field-label\">Homepage Section</label>\n+          <select\n+            value={sections[0] || \"\"}\n+            onChange={(e) =>\n+              setSections(e.target.value ? [e.target.value] : [])\n+            }\n+            className=\"tf-input\"\n+          >\n+            <option value=\"\">Choose homepage section</option>\n+            {SECTION_OPTIONS.map((opt) => (\n+              <option key={opt.value} value={opt.value}>\n+                {opt.label}\n+              </option>\n+            ))}\n+          </select>\n+          <small className=\"text-body-2\">Hold Cmd/Ctrl to multi-select (not used here).</small>\n+\n+          <input\n+            placeholder=\"Meta Title\"\n+            value={blog.metaTitle}\n+            onChange={(e) => setBlog((s) => ({ ...s!, metaTitle: e.target.value }))}\n+          />\n+          <input\n+            placeholder=\"Meta Description\"\n+            value={blog.metaDescription}\n+            onChange={(e) =>\n+              setBlog((s) => ({ ...s!, metaDescription: e.target.value }))\n+            }\n+          />\n+\n+          <label style={{ display: \"flex\", gap: 8, alignItems: \"center\" }}>\n+            <input\n+              type=\"checkbox\"\n+              checked={blog.published}\n+              onChange={(e) =>\n+                setBlog((s) => ({ ...s!, published: e.target.checked }))\n+              }\n+            />\n             Published\n           </label>\n-          <button disabled={saving} style={{background:\"#111\",color:\"#fff\"}}>{saving?\"Saving...\":\"Save changes\"}</button>\n+\n+          <button disabled={saving} style={{ background: \"#111\", color: \"#fff\" }}>\n+            {saving ? \"Saving...\" : \"Save changes\"}\n+          </button>\n         </form>\n       </div>\n     </>\n   );\n"
                },
                {
                    "date": 1762588730992,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,57 +6,48 @@\n import \"react-quill/dist/quill.snow.css\";\n import Topbar from \"../components/Topbar\";\n import { SECTION_OPTIONS } from \"../constants/sections\";\n \n-type BlogForm = {\n-  title: string;\n-  postedBy: string;\n-  categoryId: string;\n-  metaTitle?: string;\n-  metaDescription?: string;\n-  contentHtml: string;\n-  published: boolean;\n-};\n-\n export default function BlogEdit() {\n   const { id } = useParams();\n-  const [cats, setCats] = useState<any[]>([]);\n-  const [blog, setBlog] = useState<BlogForm | null>(null);\n-  const [sections, setSections] = useState<string[]>([]);     // ✅ single source for sections\n+\n+  const [cats, setCats] = useState([]);\n+  const [blog, setBlog] = useState(null);\n+  const [sections, setSections] = useState([]); // single source of truth for sections\n   const [saving, setSaving] = useState(false);\n-  const [newFile, setNewFile] = useState<File | null>(null);\n+  const [newFile, setNewFile] = useState(null);\n \n   useEffect(() => {\n     (async () => {\n-      // categories\n+      // load categories\n       const { data: catsData } = await api.get(\"/api/categories\");\n       setCats(catsData);\n \n-      // load blog by id\n+      // load blog (fallback via all blogs)\n       const { data: blogs } = await api.get(\"/api/blogs\");\n-      const found = blogs.find((b: any) => b._id === id);\n+      const found = blogs.find((b) => b._id === id);\n       if (!found) {\n         alert(\"Blog not found\");\n         window.location.href = \"/blogs\";\n         return;\n       }\n \n       setBlog({\n-        title:         found.title,\n-        postedBy:      found.postedBy,\n-        categoryId:    found.category?._id || found.category,\n-        metaTitle:     found.metaTitle || \"\",\n+        title: found.title || \"\",\n+        postedBy: found.postedBy || \"\",\n+        categoryId: (found.category && (found.category._id || found.category)) || \"\",\n+        metaTitle: found.metaTitle || \"\",\n         metaDescription: found.metaDescription || \"\",\n-        contentHtml:   found.contentHtml || \"\",\n-        published:     !!found.published,\n+        contentHtml: found.contentHtml || \"\",\n+        published: !!found.published,\n       });\n \n-      // ✅ preload sections (array) for the dropdown\n+      // preload sections\n       setSections(Array.isArray(found.sections) ? found.sections : []);\n     })();\n   }, [id]);\n \n-  const quillRef = useRef<any>(null);\n+  const quillRef = useRef(null);\n   const modules = {\n     toolbar: {\n       container: [\n         [{ header: [1, 2, 3, false] }],\n@@ -94,11 +85,18 @@\n       },\n     },\n   };\n \n-  if (!blog) return (<><Topbar /><div className=\"page\">Loading...</div></>);\n+  if (!blog) {\n+    return (\n+      <>\n+        <Topbar />\n+        <div className=\"page\">Loading...</div>\n+      </>\n+    );\n+  }\n \n-  async function submit(e: React.FormEvent) {\n+  async function submit(e) {\n     e.preventDefault();\n     setSaving(true);\n \n     const form = new FormData();\n@@ -109,10 +107,10 @@\n     form.append(\"metaDescription\", blog.metaDescription || \"\");\n     form.append(\"contentHtml\", blog.contentHtml || \"\");\n     form.append(\"published\", String(blog.published));\n \n-    // ✅ send the currently selected section(s)\n-    form.append(\"sections\", JSON.stringify(sections));  // single or empty\n+    // send sections (single dropdown -> array or empty)\n+    form.append(\"sections\", JSON.stringify(sections));\n \n     if (newFile) form.append(\"mainImage\", newFile);\n \n     await adminFetch(`/api/blogs/${id}`, { method: \"PUT\", body: form });\n@@ -123,22 +121,26 @@\n     <>\n       <Topbar />\n       <div className=\"page\">\n         <h2>Edit Blog</h2>\n+\n         <form onSubmit={submit} className=\"card\">\n           <input\n             placeholder=\"Title *\"\n             value={blog.title}\n-            onChange={(e) => setBlog((s) => ({ ...s!, title: e.target.value }))}\n+            onChange={(e) => setBlog((s) => ({ ...s, title: e.target.value }))}\n           />\n           <input\n             placeholder=\"Posted by *\"\n             value={blog.postedBy}\n-            onChange={(e) => setBlog((s) => ({ ...s!, postedBy: e.target.value }))}\n+            onChange={(e) => setBlog((s) => ({ ...s, postedBy: e.target.value }))}\n           />\n+\n           <select\n             value={blog.categoryId}\n-            onChange={(e) => setBlog((s) => ({ ...s!, categoryId: e.target.value }))}\n+            onChange={(e) =>\n+              setBlog((s) => ({ ...s, categoryId: e.target.value }))\n+            }\n           >\n             <option value=\"\">Select category *</option>\n             {cats.map((c) => (\n               <option key={c._id} value={c._id}>\n@@ -157,19 +159,17 @@\n           <label>Content (rich text) *</label>\n           <ReactQuill\n             ref={quillRef}\n             value={blog.contentHtml}\n-            onChange={(v) => setBlog((s) => ({ ...s!, contentHtml: v }))}\n+            onChange={(v) => setBlog((s) => ({ ...s, contentHtml: v }))}\n             modules={modules}\n           />\n \n-          {/* ✅ single dropdown, same as Create */}\n+          {/* Single dropdown, same as Create (includes Banner) */}\n           <label className=\"field-label\">Homepage Section</label>\n           <select\n             value={sections[0] || \"\"}\n-            onChange={(e) =>\n-              setSections(e.target.value ? [e.target.value] : [])\n-            }\n+            onChange={(e) => setSections(e.target.value ? [e.target.value] : [])}\n             className=\"tf-input\"\n           >\n             <option value=\"\">Choose homepage section</option>\n             {SECTION_OPTIONS.map((opt) => (\n@@ -177,29 +177,31 @@\n                 {opt.label}\n               </option>\n             ))}\n           </select>\n-          <small className=\"text-body-2\">Hold Cmd/Ctrl to multi-select (not used here).</small>\n+          <small className=\"text-body-2\">\n+            Matches Create page behavior (single selection).\n+          </small>\n \n           <input\n             placeholder=\"Meta Title\"\n             value={blog.metaTitle}\n-            onChange={(e) => setBlog((s) => ({ ...s!, metaTitle: e.target.value }))}\n+            onChange={(e) => setBlog((s) => ({ ...s, metaTitle: e.target.value }))}\n           />\n           <input\n             placeholder=\"Meta Description\"\n             value={blog.metaDescription}\n             onChange={(e) =>\n-              setBlog((s) => ({ ...s!, metaDescription: e.target.value }))\n+              setBlog((s) => ({ ...s, metaDescription: e.target.value }))\n             }\n           />\n \n           <label style={{ display: \"flex\", gap: 8, alignItems: \"center\" }}>\n             <input\n               type=\"checkbox\"\n               checked={blog.published}\n               onChange={(e) =>\n-                setBlog((s) => ({ ...s!, published: e.target.checked }))\n+                setBlog((s) => ({ ...s, published: e.target.checked }))\n               }\n             />\n             Published\n           </label>\n"
                },
                {
                    "date": 1762629175865,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,8 +38,10 @@\n         metaTitle: found.metaTitle || \"\",\n         metaDescription: found.metaDescription || \"\",\n         contentHtml: found.contentHtml || \"\",\n         published: !!found.published,\n+        schemaMarkup: found.schemaMarkup || \"\",\n+\n       });\n \n       // preload sections\n       setSections(Array.isArray(found.sections) ? found.sections : []);\n"
                },
                {
                    "date": 1762629193167,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -196,8 +196,21 @@\n               setBlog((s) => ({ ...s, metaDescription: e.target.value }))\n             }\n           />\n \n+\n+<label className=\"field-label\">Schema Markup (optional)</label>\n+<textarea\n+  rows={6}\n+  value={blog.schemaMarkup}\n+  onChange={(e) =>\n+    setBlog((s) => ({ ...s, schemaMarkup: e.target.value }))\n+  }\n+  placeholder=\"Paste JSON-LD or custom schema here...\"\n+  style={{ fontFamily: \"monospace\", fontSize: 13 }}\n+/>\n+\n+\n           <label style={{ display: \"flex\", gap: 8, alignItems: \"center\" }}>\n             <input\n               type=\"checkbox\"\n               checked={blog.published}\n"
                },
                {
                    "date": 1762629203038,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -108,9 +108,11 @@\n     form.append(\"metaTitle\", blog.metaTitle || \"\");\n     form.append(\"metaDescription\", blog.metaDescription || \"\");\n     form.append(\"contentHtml\", blog.contentHtml || \"\");\n     form.append(\"published\", String(blog.published));\n+    form.append(\"schemaMarkup\", blog.schemaMarkup || \"\");\n \n+\n     // send sections (single dropdown -> array or empty)\n     form.append(\"sections\", JSON.stringify(sections));\n \n     if (newFile) form.append(\"mainImage\", newFile);\n"
                }
            ],
            "date": 1762276080720,
            "name": "Commit-0",
            "content": "import { useEffect, useRef, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { api } from \"../api/client\";\nimport { adminFetch } from \"../api/adminFetch\";\nimport ReactQuill from \"react-quill\";\nimport \"react-quill/dist/quill.snow.css\";\nimport Topbar from \"../components/Topbar\";\n\nexport default function BlogEdit() {\n  const { id } = useParams();\n  const [cats, setCats] = useState([]);\n  const [blog, setBlog] = useState(null);\n  const [saving, setSaving] = useState(false);\n  const [newFile, setNewFile] = useState(null);\n\n  useEffect(() => {\n    (async () => {\n      const { data: catsData } = await api.get(\"/api/categories\");\n      setCats(catsData);\n      // fallback: fetch all blogs and find by id\n      const { data: blogs } = await api.get(\"/api/blogs\");\n      const found = blogs.find(b => b._id === id);\n      if (!found) { alert(\"Blog not found\"); window.location.href=\"/blogs\"; return; }\n      setBlog({\n        title: found.title,\n        postedBy: found.postedBy,\n        categoryId: found.category?._id || found.category,\n        metaTitle: found.metaTitle || \"\",\n        metaDescription: found.metaDescription || \"\",\n        contentHtml: found.contentHtml || \"\",\n        published: !!found.published,\n      });\n    })();\n  }, [id]);\n\n  const quillRef = useRef(null);\n  const modules = {\n    toolbar: {\n      container: [\n        [{ header: [1,2,3,false] }],\n        [\"bold\",\"italic\",\"underline\"],\n        [{ list: \"ordered\" }, { list: \"bullet\" }],\n        [\"link\",\"image\"],\n        [\"clean\"]\n      ],\n      handlers: {\n        image: async function() {\n          const input = document.createElement(\"input\");\n          input.type = \"file\"; input.accept = \"image/*\";\n          input.onchange = async () => {\n            const f = input.files?.[0]; if (!f) return;\n            const form = new FormData();\n            form.append(\"image\", f);\n            const token = localStorage.getItem(\"admin_token\");\n            const res = await fetch(`${import.meta.env.VITE_API_BASE}/api/uploads/image`, {\n              method: \"POST\",\n              headers: token ? { Authorization: `Bearer ${token}` } : undefined,\n              body: form\n            });\n            const { url } = await res.json();\n            const editor = quillRef.current.getEditor();\n            const range = editor.getSelection(true);\n            editor.insertEmbed(range.index, \"image\", url);\n          };\n          input.click();\n        }\n      }\n    }\n  };\n\n  if (!blog) return (<><Topbar/><div className=\"page\">Loading...</div></>);\n\n  async function submit(e) {\n    e.preventDefault();\n    setSaving(true);\n    const form = new FormData();\n    form.append(\"title\", blog.title);\n    form.append(\"postedBy\", blog.postedBy);\n    form.append(\"categoryId\", blog.categoryId);\n    form.append(\"metaTitle\", blog.metaTitle);\n    form.append(\"metaDescription\", blog.metaDescription);\n    form.append(\"contentHtml\", blog.contentHtml);\n    form.append(\"published\", String(blog.published));\n    if (newFile) form.append(\"mainImage\", newFile);\n\n    await adminFetch(`/api/blogs/${id}`, { method: \"PUT\", body: form });\n    window.location.href = \"/blogs\";\n  }\n\n  return (\n    <>\n      <Topbar/>\n      <div className=\"page\">\n        <h2>Edit Blog</h2>\n        <form onSubmit={submit} className=\"card\">\n          <input placeholder=\"Title *\" value={blog.title} onChange={e=>setBlog(s=>({...s, title:e.target.value}))} />\n          <input placeholder=\"Posted by *\" value={blog.postedBy} onChange={e=>setBlog(s=>({...s, postedBy:e.target.value}))} />\n          <select value={blog.categoryId} onChange={e=>setBlog(s=>({...s, categoryId:e.target.value}))}>\n            <option value=\"\">Select category *</option>\n            {cats.map(c=><option key={c._id} value={c._id}>{c.name}</option>)}\n          </select>\n          <label>Replace Main Image (optional)</label>\n          <input type=\"file\" accept=\"image/*\" onChange={e=>setNewFile(e.target.files?.[0] || null)} />\n          <label>Content (rich text) *</label>\n          <ReactQuill ref={quillRef} value={blog.contentHtml} onChange={v=>setBlog(s=>({...s, contentHtml:v}))} modules={modules} />\n          <input placeholder=\"Meta Title\" value={blog.metaTitle} onChange={e=>setBlog(s=>({...s, metaTitle:e.target.value}))} />\n          <input placeholder=\"Meta Description\" value={blog.metaDescription} onChange={e=>setBlog(s=>({...s, metaDescription:e.target.value}))} />\n          <label style={{display:\"flex\",gap:8,alignItems:\"center\"}}>\n            <input type=\"checkbox\" checked={blog.published} onChange={e=>setBlog(s=>({...s, published:e.target.checked}))}/>\n            Published\n          </label>\n          <button disabled={saving} style={{background:\"#111\",color:\"#fff\"}}>{saving?\"Saving...\":\"Save changes\"}</button>\n        </form>\n      </div>\n    </>\n  );\n}\n"
        }
    ]
}