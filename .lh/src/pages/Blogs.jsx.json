{
    "sourceFile": "src/pages/Blogs.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1762268918595,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1762276063209,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,86 @@\n+import { useEffect, useState } from \"react\";\n+import { api } from \"../api/client\";\n+import Topbar from \"../components/Topbar\";\n+\n+export default function Categories() {\n+  const [items, setItems] = useState([]);\n+  const [form, setForm] = useState({ name: \"\", metaTitle: \"\", metaDescription: \"\" });\n+  const [editingId, setEditingId] = useState(null);\n+  const [loading, setLoading] = useState(false);\n+\n+  async function load() {\n+    const { data } = await api.get(\"/api/categories\");\n+    setItems(data);\n+  }\n+  useEffect(() => { load(); }, []);\n+\n+  async function create(e) {\n+    e.preventDefault();\n+    if (!form.name.trim()) return;\n+    setLoading(true);\n+    await api.post(\"/api/categories\", form);\n+    setForm({ name: \"\", metaTitle: \"\", metaDescription: \"\" });\n+    await load();\n+    setLoading(false);\n+  }\n+\n+  async function startEdit(cat) {\n+    setEditingId(cat._id);\n+    setForm({ name: cat.name, metaTitle: cat.metaTitle || \"\", metaDescription: cat.metaDescription || \"\" });\n+  }\n+\n+  async function saveEdit() {\n+    if (!editingId) return;\n+    await api.put(`/api/categories/${editingId}`, form);\n+    setEditingId(null);\n+    setForm({ name: \"\", metaTitle: \"\", metaDescription: \"\" });\n+    await load();\n+  }\n+\n+  async function remove(id) {\n+    if (!confirm(\"Delete category?\")) return;\n+    await api.delete(`/api/categories/${id}`);\n+    await load();\n+  }\n+\n+  return (\n+    <>\n+      <Topbar/>\n+      <div className=\"page\">\n+        <h2>Categories</h2>\n+\n+        <form onSubmit={create} className=\"card\" style={{maxWidth:600}}>\n+          <strong>{editingId ? \"Editing category\" : \"Create new category\"}</strong>\n+          <input placeholder=\"Name *\" value={form.name} onChange={e=>setForm(s=>({...s, name:e.target.value}))}/>\n+          <input placeholder=\"Meta Title\" value={form.metaTitle} onChange={e=>setForm(s=>({...s, metaTitle:e.target.value}))}/>\n+          <input placeholder=\"Meta Description\" value={form.metaDescription} onChange={e=>setForm(s=>({...s, metaDescription:e.target.value}))}/>\n+          {editingId ? (\n+            <div style={{display:\"flex\",gap:8}}>\n+              <button type=\"button\" onClick={()=>{setEditingId(null); setForm({name:\"\",metaTitle:\"\",metaDescription:\"\"});}}>Cancel</button>\n+              <button type=\"button\" onClick={saveEdit} style={{background:\"#111\",color:\"#fff\"}}>Save</button>\n+            </div>\n+          ) : (\n+            <button disabled={loading} style={{background:\"#111\",color:\"#fff\"}}>{loading?\"Saving...\":\"Create\"}</button>\n+          )}\n+        </form>\n+\n+        <table className=\"table\" style={{marginTop:16}}>\n+          <thead><tr><th>Name</th><th>Slug</th><th>SEO Title</th><th>Actions</th></tr></thead>\n+          <tbody>\n+            {items.map(c=>(\n+              <tr key={c._id}>\n+                <td>{c.name}</td>\n+                <td>{c.slug}</td>\n+                <td>{c.metaTitle || \"-\"}</td>\n+                <td>\n+                  <button onClick={()=>startEdit(c)}>Edit</button>\n+                  <button onClick={()=>remove(c._id)} style={{marginLeft:8}}>Delete</button>\n+                </td>\n+              </tr>\n+            ))}\n+          </tbody>\n+        </table>\n+      </div>\n+    </>\n+  );\n+}\n"
                },
                {
                    "date": 1762276660847,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,105 +1,22 @@\n import { useEffect, useState } from \"react\";\n import { api } from \"../api/client\";\n+import { Link } from \"react-router-dom\";\n import Topbar from \"../components/Topbar\";\n \n-export default function Categories() {\n-  const [items, setItems] = useState([]);\n-  const [form, setForm] = useState({ name: \"\", metaTitle: \"\", metaDescription: \"\" });\n-  const [editingId, setEditingId] = useState(null);\n-  const [loading, setLoading] = useState(false);\n+export default function Blogs() {\n+  const [blogs, setBlogs] = useState([]);\n \n   async function load() {\n-    const { data } = await api.get(\"/api/categories\");\n-    setItems(data);\n+    const { data } = await api.get(\"/api/blogs\"); // public list (published=true)\n+    setBlogs(data);\n   }\n   useEffect(() => { load(); }, []);\n \n-  async function create(e) {\n-    e.preventDefault();\n-    if (!form.name.trim()) return;\n-    setLoading(true);\n-    await api.post(\"/api/categories\", form);\n-    setForm({ name: \"\", metaTitle: \"\", metaDescription: \"\" });\n-    await load();\n-    setLoading(false);\n-  }\n-\n-  async function startEdit(cat) {\n-    setEditingId(cat._id);\n-    setForm({ name: cat.name, metaTitle: cat.metaTitle || \"\", metaDescription: cat.metaDescription || \"\" });\n-  }\n-\n-  async function saveEdit() {\n-    if (!editingId) return;\n-    await api.put(`/api/categories/${editingId}`, form);\n-    setEditingId(null);\n-    setForm({ name: \"\", metaTitle: \"\", metaDescription: \"\" });\n-    await load();\n-  }\n-\n   async function remove(id) {\n-    if (!confirm(\"Delete category?\")) return;\n-    await api.delete(`/api/categories/${id}`);\n-    await load();\n-  }\n-\n-  return (\n-    <>\n-      <Topbar/>\n-      <div className=\"page\">\n-        <h2>Categories</h2>\n-\n-        <form onSubmit={create} className=\"card\" style={{maxWidth:600}}>\n-          <strong>{editingId ? \"Editing category\" : \"Create new category\"}</strong>\n-          <input placeholder=\"Name *\" value={form.name} onChange={e=>setForm(s=>({...s, name:e.target.value}))}/>\n-          <input placeholder=\"Meta Title\" value={form.metaTitle} onChange={e=>setForm(s=>({...s, metaTitle:e.target.value}))}/>\n-          <input placeholder=\"Meta Description\" value={form.metaDescription} onChange={e=>setForm(s=>({...s, metaDescription:e.target.value}))}/>\n-          {editingId ? (\n-            <div style={{display:\"flex\",gap:8}}>\n-              <button type=\"button\" onClick={()=>{setEditingId(null); setForm({name:\"\",metaTitle:\"\",metaDescription:\"\"});}}>Cancel</button>\n-              <button type=\"button\" onClick={saveEdit} style={{background:\"#111\",color:\"#fff\"}}>Save</button>\n-            </div>\n-          ) : (\n-            <button disabled={loading} style={{background:\"#111\",color:\"#fff\"}}>{loading?\"Saving...\":\"Create\"}</button>\n-          )}\n-        </form>\n-\n-        <table className=\"table\" style={{marginTop:16}}>\n-          <thead><tr><th>Name</th><th>Slug</th><th>SEO Title</th><th>Actions</th></tr></thead>\n-          <tbody>\n-            {items.map(c=>(\n-              <tr key={c._id}>\n-                <td>{c.name}</td>\n-                <td>{c.slug}</td>\n-                <td>{c.metaTitle || \"-\"}</td>\n-                <td>\n-                  <button onClick={()=>startEdit(c)}>Edit</button>\n-                  <button onClick={()=>remove(c._id)} style={{marginLeft:8}}>Delete</button>\n-                </td>\n-              </tr>\n-            ))}\n-          </tbody>\n-        </table>\n-      </div>\n-    </>\n-  );\n-}\n-import { useEffect, useState } from \"react\";\n-import { api } from \"../api/client\";\n-import { Link } from \"react-router-dom\";\n-import Topbar from \"../components/Topbar\";\n-\n-export default function Blogs() {\n-  const [blogs, setBlogs] = useState([]);\n-  useEffect(() => {\n-    api.get(\"/api/blogs\").then(({data}) => setBlogs(data));\n-  }, []);\n-\n-  async function remove(id) {\n     if (!confirm(\"Delete blog?\")) return;\n     await api.delete(`/api/blogs/${id}`);\n-    setBlogs(prev => prev.filter(b => b._id !== id));\n+    await load();\n   }\n \n   return (\n     <>\n@@ -108,15 +25,17 @@\n         <div className=\"row\">\n           <h2>Blogs</h2>\n           <Link className=\"btn\" to=\"/blogs/create\">+ New</Link>\n         </div>\n+\n         <table className=\"table\">\n-          <thead><tr><th>Title</th><th>Category</th><th>Actions</th></tr></thead>\n+          <thead><tr><th>Title</th><th>Category</th><th>Published</th><th>Actions</th></tr></thead>\n           <tbody>\n             {blogs.map(b=>(\n               <tr key={b._id}>\n                 <td>{b.title}</td>\n-                <td>{b.category?.name}</td>\n+                <td>{b.category?.name || \"-\"}</td>\n+                <td>{b.published ? \"Yes\" : \"No\"}</td>\n                 <td>\n                   <Link to={`/blogs/${b._id}/edit`}>Edit</Link>\n                   <button onClick={()=>remove(b._id)} style={{marginLeft:8}}>Delete</button>\n                 </td>\n"
                },
                {
                    "date": 1762594890282,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,49 +1,201 @@\n-import { useEffect, useState } from \"react\";\n-import { api } from \"../api/client\";\n+import { useEffect, useMemo, useState } from \"react\";\n import { Link } from \"react-router-dom\";\n import Topbar from \"../components/Topbar\";\n+import { api } from \"../api/client\";\n+import { adminFetch } from \"../api/adminFetch\";\n+import { SECTION_OPTIONS } from \"../constants/sections\";\n \n+// Map machine values -> human labels, e.g. \"editors_pick\" → \"Editor Pick's\"\n+const SECTION_LABELS = SECTION_OPTIONS.reduce((acc, o) => {\n+  acc[o.value] = o.label;\n+  return acc;\n+}, /** @type {Record<string,string>} */ ({}));\n+\n+const PER_PAGE = 50;\n+\n export default function Blogs() {\n-  const [blogs, setBlogs] = useState([]);\n+  const [rows, setRows] = useState([]);\n+  const [loading, setLoading] = useState(true);\n+  const [err, setErr] = useState(\"\");\n+  const [page, setPage] = useState(1);\n \n-  async function load() {\n-    const { data } = await api.get(\"/api/blogs\"); // public list (published=true)\n-    setBlogs(data);\n-  }\n-  useEffect(() => { load(); }, []);\n+  useEffect(() => {\n+    let cancel = false;\n+    (async () => {\n+      try {\n+        setLoading(true);\n+        const { data } = await api.get(\"/api/blogs\");\n+        if (!cancel) {\n+          setRows(Array.isArray(data) ? data : []);\n+          setErr(\"\");\n+        }\n+      } catch (e) {\n+        if (!cancel) setErr(\"Failed to load blogs.\");\n+      } finally {\n+        if (!cancel) setLoading(false);\n+      }\n+    })();\n+    return () => {\n+      cancel = true;\n+    };\n+  }, []);\n \n-  async function remove(id) {\n-    if (!confirm(\"Delete blog?\")) return;\n-    await api.delete(`/api/blogs/${id}`);\n-    await load();\n+  const totalPages = Math.max(1, Math.ceil(rows.length / PER_PAGE));\n+  const current = Math.min(page, totalPages);\n+\n+  const visible = useMemo(() => {\n+    const start = (current - 1) * PER_PAGE;\n+    return rows.slice(start, start + PER_PAGE);\n+  }, [rows, current]);\n+\n+  async function onDelete(id) {\n+    if (!confirm(\"Delete this blog?\")) return;\n+    await adminFetch(`/api/blogs/${id}`, { method: \"DELETE\" });\n+    setRows((r) => r.filter((x) => x._id !== id));\n   }\n \n   return (\n     <>\n-      <Topbar/>\n+      <Topbar />\n       <div className=\"page\">\n-        <div className=\"row\">\n+        <div className=\"list-header\">\n           <h2>Blogs</h2>\n-          <Link className=\"btn\" to=\"/blogs/create\">+ New</Link>\n+          <Link className=\"btn primary\" to=\"/blogs/create\">+ New</Link>\n         </div>\n \n-        <table className=\"table\">\n-          <thead><tr><th>Title</th><th>Category</th><th>Published</th><th>Actions</th></tr></thead>\n-          <tbody>\n-            {blogs.map(b=>(\n-              <tr key={b._id}>\n-                <td>{b.title}</td>\n-                <td>{b.category?.name || \"-\"}</td>\n-                <td>{b.published ? \"Yes\" : \"No\"}</td>\n-                <td>\n-                  <Link to={`/blogs/${b._id}/edit`}>Edit</Link>\n-                  <button onClick={()=>remove(b._id)} style={{marginLeft:8}}>Delete</button>\n-                </td>\n+        {err ? <div className=\"alert error\">{err}</div> : null}\n+\n+        <div className=\"table-wrap\">\n+          <table className=\"tbl\">\n+            <thead>\n+              <tr>\n+                <th style={{ width: \"48%\" }}>Title</th>\n+                <th style={{ width: \"14%\" }}>Category</th>\n+                <th style={{ width: \"10%\" }}>Published</th>\n+                <th style={{ width: \"18%\" }}>Sections</th>\n+                <th style={{ width: \"10%\" }} className=\"ta-right\">Actions</th>\n               </tr>\n-            ))}\n-          </tbody>\n-        </table>\n+            </thead>\n+            <tbody>\n+              {loading ? (\n+                <tr>\n+                  <td colSpan={5} style={{ textAlign: \"center\" }}>\n+                    Loading…\n+                  </td>\n+                </tr>\n+              ) : visible.length ? (\n+                visible.map((b) => (\n+                  <tr key={b._id}>\n+                    <td className=\"ellipsis\">\n+                      <Link to={`/blogs/${b._id}/edit`} className=\"row-title\">\n+                        {b.title}\n+                      </Link>\n+                    </td>\n+                    <td>{b.category?.name || \"-\"}</td>\n+                    <td>{b.published ? \"Yes\" : \"No\"}</td>\n+                    <td>\n+                      <div className=\"chips\">\n+                        {(b.sections || []).length ? (\n+                          b.sections.map((s) => (\n+                            <span key={s} className=\"chip\">\n+                              {SECTION_LABELS[s] || s}\n+                            </span>\n+                          ))\n+                        ) : (\n+                          <span className=\"muted\">—</span>\n+                        )}\n+                      </div>\n+                    </td>\n+                    <td className=\"ta-right\">\n+                      <Link to={`/blogs/${b._id}/edit`} className=\"btn xs\">\n+                        Edit\n+                      </Link>\n+                      <button className=\"btn xs danger\" onClick={() => onDelete(b._id)}>\n+                        Delete\n+                      </button>\n+                    </td>\n+                  </tr>\n+                ))\n+              ) : (\n+                <tr>\n+                  <td colSpan={5} style={{ textAlign: \"center\" }}>\n+                    No blogs found.\n+                  </td>\n+                </tr>\n+              )}\n+            </tbody>\n+          </table>\n+        </div>\n+\n+        {/* Pagination (client-side, 50 per page) */}\n+        {rows.length > PER_PAGE && (\n+          <div className=\"pagination\">\n+            <button\n+              className=\"pg-btn\"\n+              disabled={current === 1}\n+              onClick={() => setPage(1)}\n+              aria-label=\"First\"\n+            >\n+              «\n+            </button>\n+            <button\n+              className=\"pg-btn\"\n+              disabled={current === 1}\n+              onClick={() => setPage((p) => Math.max(1, p - 1))}\n+              aria-label=\"Previous\"\n+            >\n+              ‹\n+            </button>\n+            <span className=\"pg-info\">\n+              Page {current} of {totalPages}\n+            </span>\n+            <button\n+              className=\"pg-btn\"\n+              disabled={current === totalPages}\n+              onClick={() => setPage((p) => Math.min(totalPages, p + 1))}\n+              aria-label=\"Next\"\n+            >\n+              ›\n+            </button>\n+            <button\n+              className=\"pg-btn\"\n+              disabled={current === totalPages}\n+              onClick={() => setPage(totalPages)}\n+              aria-label=\"Last\"\n+            >\n+              »\n+            </button>\n+          </div>\n+        )}\n       </div>\n+\n+      {/* Minimal styles for chips/table/pagination */}\n+      <style>{`\n+        .list-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:12px; }\n+        .btn { padding:8px 12px; border:1px solid #e5e7eb; border-radius:8px; background:#fff; text-decoration:none; color:#111; font-weight:600; }\n+        .btn.primary { background:#111; color:#fff; border-color:#111; }\n+        .btn.xs { padding:6px 8px; margin-left:6px; }\n+        .btn.danger { background:#fee2e2; border-color:#fecaca; color:#991b1b; }\n+        .alert.error { background:#fee2e2; color:#991b1b; border:1px solid #fecaca; padding:10px 12px; border-radius:8px; margin:8px 0; }\n+\n+        .table-wrap { overflow:auto; background:#fff; border:1px solid #e5e7eb; border-radius:12px; }\n+        .tbl { width:100%; border-collapse:collapse; }\n+        .tbl th, .tbl td { padding:12px 14px; border-bottom:1px solid #f3f4f6; vertical-align:middle; }\n+        .tbl th { background:#fafafa; text-align:left; font-weight:700; }\n+        .row-title { color:#111827; text-decoration:none; }\n+        .row-title:hover { text-decoration:underline; }\n+        .ellipsis { max-width: 0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }\n+        .muted { color:#6b7280; }\n+        .ta-right { text-align:right; }\n+\n+        .chips { display:flex; flex-wrap:wrap; gap:6px; }\n+        .chip { padding:3px 8px; font-size:12px; border-radius:999px; background:#eef2ff; color:#3730a3; border:1px solid #e0e7ff; line-height:1.6; }\n+\n+        .pagination { display:flex; align-items:center; gap:8px; margin-top:12px; }\n+        .pg-btn { padding:6px 10px; border:1px solid #e5e7eb; border-radius:8px; background:#fff; }\n+        .pg-btn[disabled] { opacity:.5; cursor:not-allowed; }\n+        .pg-info { color:#6b7280; padding:0 6px; }\n+      `}</style>\n     </>\n   );\n }\n"
                }
            ],
            "date": 1762268918595,
            "name": "Commit-0",
            "content": "import { useEffect, useState } from \"react\";\nimport { api } from \"../api/client\";\nimport { Link } from \"react-router-dom\";\nimport Topbar from \"../components/Topbar\";\n\nexport default function Blogs() {\n  const [blogs, setBlogs] = useState([]);\n  useEffect(() => {\n    api.get(\"/api/blogs\").then(({data}) => setBlogs(data));\n  }, []);\n\n  async function remove(id) {\n    if (!confirm(\"Delete blog?\")) return;\n    await api.delete(`/api/blogs/${id}`);\n    setBlogs(prev => prev.filter(b => b._id !== id));\n  }\n\n  return (\n    <>\n      <Topbar/>\n      <div className=\"page\">\n        <div className=\"row\">\n          <h2>Blogs</h2>\n          <Link className=\"btn\" to=\"/blogs/create\">+ New</Link>\n        </div>\n        <table className=\"table\">\n          <thead><tr><th>Title</th><th>Category</th><th>Actions</th></tr></thead>\n          <tbody>\n            {blogs.map(b=>(\n              <tr key={b._id}>\n                <td>{b.title}</td>\n                <td>{b.category?.name}</td>\n                <td>\n                  <Link to={`/blogs/${b._id}/edit`}>Edit</Link>\n                  <button onClick={()=>remove(b._id)} style={{marginLeft:8}}>Delete</button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </>\n  );\n}\n"
        }
    ]
}